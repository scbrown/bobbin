{"id":"bobbin-07d","title":"Phase 1: Foundation (MVP)","description":"Basic indexing and search working end-to-end. Exit criteria: Can index a medium repo and run semantic + keyword search.","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-02T15:32:05.697013-05:00","created_by":"stiwi","updated_at":"2026-01-02T15:32:05.697013-05:00"}
{"id":"bobbin-1hc","title":"Fix worktree cleanup in finish-agent.sh script","description":"The finish-agent.sh script fails to remove worktrees when run from within the worktree itself. It tries to delete the branch while it's still checked out, and the worktree path resolution has issues.\n\nError observed:\n- 'Cannot delete branch checked out at worktree'\n- Worktree path resolution fails (double ../bobbin-worktrees)\n\nShould handle the case where the agent is running from inside the worktree being cleaned up.\n\nAdditionally: In start-agent.sh, after the agent session closes (claude exits), check if the worktree still exists (i.e., wasn't merged). If the worktree is still present, issue a warning message and provide the command to finish the task:\n  \n  just tambour finish \u003cissue-id\u003e\n\nThis helps users know what to do next when the agent exits without merging.","status":"closed","priority":3,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T19:42:04.372845-05:00","created_by":"stiwi","updated_at":"2026-01-02T20:27:21.708673-05:00","closed_at":"2026-01-02T20:27:21.708673-05:00","close_reason":"Closed","labels":["tambour"]}
{"id":"bobbin-3lt","title":"Implement task depletion flow with completion context injection","description":"## Summary\n\nWhen tambour finishes a task and there are no more ready tasks in the queue, it should:\n\n1. **Detect task depletion** - After completing a task, check if `bd ready` returns empty\n2. **Present completion summary** - Show what was just completed:\n   - The task that just finished\n   - Any epics that were auto-closed (beads closes epics when all children complete)\n   - Any other tasks that were auto-closed via `closes:` references\n3. **Prompt user to create more tasks** - Offer to help create new issues\n4. **If user creates tasks, spawn new session with context** - Create a new Claude session that includes:\n   - Summary of what was just completed\n   - Any closed epics (so the agent understands the broader context)\n   - The new task assignment\n\n## Technical Details\n\n### Epic awareness\n- After task completion, query beads to see if any epics changed status\n- Track epic state before/after task completion\n- Include epic completion in the context injection\n\n### Auto-close awareness  \n- Parse beads output for `closes:` resolution\n- Track which issues were transitively closed\n- Include these in the completion summary\n\n### Context injection format\n```\nPrevious session completed:\n- Task: bobbin-xyz \"Implement feature X\"\n- Also closed: bobbin-abc (via closes: reference)\n- Epic completed: bobbin-epic \"Phase 1\" (all children done)\n\nYou are now assigned to: bobbin-new \"Next task\"\n```\n\n### Flow\n1. `finish-agent.sh` completes → task closed\n2. Check `bd ready --json` for remaining tasks\n3. If empty:\n   - Show completion summary\n   - Ask \"Create more tasks? (y/n)\"\n   - If yes, open interactive task creation\n   - After creation, auto-spawn new agent with context\n4. If tasks remain:\n   - Ask \"Continue to next task? (y/n)\" \n   - If yes, spawn with completion context injected\n\n## Acceptance Criteria\n- [ ] Detects when ready queue is empty after task completion\n- [ ] Correctly identifies auto-closed epics\n- [ ] Correctly identifies `closes:` transitive closures\n- [ ] Context injection includes all completion information\n- [ ] New sessions receive relevant prior context","status":"closed","priority":3,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T19:02:00.084228-05:00","created_by":"stiwi","updated_at":"2026-01-02T19:58:22.787412-05:00","closed_at":"2026-01-02T19:58:22.787412-05:00","close_reason":"Closed","labels":["tambour"]}
{"id":"bobbin-66i","title":"Phase 3: Polish \u0026 Integration","description":"Focus on external integrations (MCP), performance, and developer experience.","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-03T01:20:01.235169-05:00","created_by":"stiwi","updated_at":"2026-01-03T01:20:01.235169-05:00"}
{"id":"bobbin-66i.1","title":"Implement MCP Server Integration","description":"## Objective\nExpose Bobbin's functionality via the Model Context Protocol (MCP) to allow AI agents (Claude, Cursor) to use it as a tool.\n\n## Requirements\n- **Transport**: Stdio transport (JSON-RPC over stdin/stdout).\n- **Tools**:\n  - `search`: Semantic search.\n  - `grep`: Keyword search.\n  - `related`: Get related files.\n  - `read_chunk`: Read specific code chunk.\n- **Resources**:\n  - `bobbin://index/stats`: Index statistics.\n- **Prompts**:\n  - `explore_codebase`: Guided exploration prompt.\n\n## Implementation Details\n- Use `mcp-sdk-rs` (or implement JSON-RPC manually if SDK is immature).\n- Create `src/mcp/` module.\n- Add `bobbin serve` command.","status":"in_progress","priority":2,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-03T01:20:23.324088-05:00","created_by":"stiwi","updated_at":"2026-01-05T22:00:24.881359-05:00","dependencies":[{"issue_id":"bobbin-66i.1","depends_on_id":"bobbin-66i","type":"parent-child","created_at":"2026-01-03T01:20:23.325813-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6nh","title":"Tool Use Metrics \u0026 Context Intelligence","description":"Implement plugin-based metrics collection to capture tool use patterns and drive intelligent context injection.\n\nSee docs/tambour-metrics.md for full design.\n\n## Architecture\n\nThis system integrates with tambour's plugin infrastructure (from bobbin-iac):\n1. Claude Code `PostToolUse` hook acts as a thin bridge emitting tambour events\n2. Tambour event dispatcher routes `tool.used` events to subscribed plugins\n3. Metrics collector plugin processes events and stores to JSONL\n4. Aggregation layer derives insights (hot files, complexity signals)\n\n## Goals\n- Bridge Claude Code hooks into tambour's event system\n- Capture tool use metrics via metrics-collector plugin\n- Track file access patterns, success/failure rates, and timing\n- Identify \"hot files\" that should be auto-injected as context\n- Detect complex files that may need documentation review\n- Provide analytics and insights into agent behavior\n\n## Use Cases\n1. **Hot File Detection** - Files read frequently across sessions get auto-injected\n2. **Complexity Detection** - Flag files with multiple re-reads or failed edits\n3. **Success/Failure Tracking** - Visibility into what's working and failing\n4. **Session Analytics** - Understand productivity patterns\n\n## Success Criteria\n- Bridge emits tool.used events to tambour dispatcher\n- Metrics collector plugin captures events reliably\n- Hot files identified and injected into new sessions\n- Complex files flagged with actionable insights\n- Minimal performance overhead (\u003c 5ms per tool use)","status":"open","priority":4,"issue_type":"epic","created_at":"2026-01-05T18:20:18.346723-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:35:25.389407-05:00","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-6nh","depends_on_id":"bobbin-iac","type":"blocks","created_at":"2026-01-05T18:35:12.767962-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6nh.1","title":"Implement metrics collector script","description":"Create the core metrics collection script that receives PostToolUse hook events.\n\n## Purpose\nThe collector is the foundational component that captures tool use events from Claude Code and stores them for analysis.\n\n## Implementation\n\n### Script Location\n`tambour/src/tambour/metrics/collector.py`\n\n### Input (via stdin from hook)\n```json\n{\n  \"session_id\": \"abc123\",\n  \"tool_name\": \"Read\",\n  \"tool_input\": {\"file_path\": \"/path/to/file.rs\"},\n  \"tool_response\": {\"success\": true, \"lines\": 150},\n  \"tool_use_id\": \"toolu_xxx\"\n}\n```\n\n### Output (append to JSONL)\n```json\n{\n  \"timestamp\": \"2026-01-05T10:30:00Z\",\n  \"session_id\": \"abc123\",\n  \"issue_id\": \"bobbin-xyz\",\n  \"worktree\": \"/path/to/worktree\",\n  \"tool\": \"Read\",\n  \"input\": {\"file_path\": \"/path/to/file.rs\"},\n  \"output\": {\"success\": true, \"lines\": 150},\n  \"duration_ms\": null,\n  \"error\": null\n}\n```\n\n### Key Requirements\n1. Parse JSON from stdin\n2. Extract relevant fields based on tool type\n3. Infer issue_id from worktree path or git branch\n4. Append to `.tambour/metrics.jsonl`\n5. Handle errors gracefully (never crash the hook)\n6. Complete in \u003c 5ms to avoid slowing agent\n\n### Tool-Specific Extraction\n| Tool | Fields to Extract |\n|------|-------------------|\n| Read | file_path, offset, limit |\n| Write | file_path, content length |\n| Edit | file_path, old/new string lengths |\n| Glob | pattern, path |\n| Grep | pattern, path, output_mode |\n| Bash | command prefix, description |\n\n## Testing\n- Unit tests for JSON parsing\n- Tests for each tool type extraction\n- Error handling tests (malformed input, missing fields)\n\n## Validates\n- Core metrics infrastructure works\n- JSONL storage is reliable\n- Performance is acceptable","status":"tombstone","priority":4,"issue_type":"task","created_at":"2026-01-05T18:20:35.307045-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:44:09.036113-05:00","labels":["tambour"],"deleted_at":"2026-01-05T18:44:09.036113-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"bobbin-6nh.10","title":"Add automatic issue creation for complex files","description":"Implement automatic beads issue creation for files with complexity signals.\n\n## Purpose\nWhen files consistently show complexity signals, automatically create beads issues to track documentation or refactoring improvements.\n\n## Workflow\n```\nComplexity Detection\n        ↓\nFiles with critical signals\n        ↓\nCheck for existing issues (avoid duplicates)\n        ↓\nCreate beads issue\n        ↓\nLink to metrics data\n```\n\n## Issue Template\n\n### Documentation Review Issue\n```\nTitle: Review documentation for src/parser.rs\n\nType: task\nPriority: P4\nLabels: [documentation, auto-generated]\n\nDescription:\nThis file has been flagged by tambour metrics as potentially needing documentation improvements.\n\n## Metrics Summary\n- Read 34 times across 8 sessions\n- Average 4.25 reads per session (threshold: 3.0)\n- Edit success rate: 75%\n\n## Detected Signals\n- High re-read rate: Agents are re-reading this file multiple times per session\n- Edit failures: Some edit attempts are failing to match expected content\n\n## Recommendations\n- Add inline documentation explaining key functions\n- Consider adding a summary comment at the top\n- Review code structure for clarity\n\n## Generated By\nAuto-created by tambour metrics on 2026-01-05\nBased on data from sessions: abc123, def456, ...\n```\n\n## Implementation\n\n### Module Location\n`tambour/src/tambour/metrics/auto_issues.py`\n\n### API\n```python\nfrom tambour.metrics.auto_issues import IssueGenerator\n\ngenerator = IssueGenerator(config)\nnew_issues = generator.create_issues(complexity_results)\n\nfor issue in new_issues:\n    print(f\"Created: {issue.id} - {issue.title}\")\n```\n\n### Duplicate Detection\nBefore creating an issue:\n1. Search existing open issues for the file path\n2. Check for `auto-generated` label with same file\n3. If exists and still open, skip or update instead\n\n```python\ndef find_existing_issue(file_path: str) -\u003e Optional[str]:\n    # Use beads CLI to search\n    result = subprocess.run(\n        [\"bd\", \"list\", \"--label\", \"auto-generated\", \"--status\", \"open\"],\n        capture_output=True\n    )\n    # Parse and check for matching file path in descriptions\n    ...\n```\n\n### Configuration\n```toml\n[metrics.auto_issues]\nenabled = false  # Opt-in, off by default\nmin_severity = \"warning\"  # Only create for warning/critical\nlabels = [\"documentation\", \"auto-generated\"]\npriority = \"P4\"\ndry_run = false  # If true, log but don't create\n```\n\n### CLI Integration\n```bash\n# Manual trigger\npython -m tambour metrics create-issues [--dry-run]\n\n# Show what would be created\npython -m tambour metrics create-issues --dry-run\n```\n\nOutput:\n```\n=== Auto-Issue Preview (Dry Run) ===\n\nWould create issue for src/parser.rs:\n  Title: Review documentation for src/parser.rs\n  Signals: high_reread_rate, edit_failures\n  Priority: P4\n\nWould create issue for src/ast.rs:\n  Title: Review documentation for src/ast.rs\n  Signals: high_reread_rate\n  Priority: P4\n\n2 issues would be created. Run without --dry-run to create.\n```\n\n## Safety Features\n1. **Off by default** - Must explicitly enable in config\n2. **Dry run mode** - Preview before creating\n3. **Duplicate detection** - Won't create if issue exists\n4. **Severity threshold** - Only create for significant signals\n5. **Rate limiting** - Maximum issues per run (default: 5)\n\n## Testing\n- Unit tests for issue generation\n- Integration test with beads CLI (mocked)\n- Duplicate detection tests\n- Dry run mode tests\n- Configuration validation tests\n\n## Acceptance Criteria\n- [ ] Creates well-formatted beads issues\n- [ ] Detects and skips duplicates\n- [ ] Respects configuration (enabled, min_severity, etc.)\n- [ ] Dry run mode works correctly\n- [ ] Integrates with CLI (tambour metrics create-issues)\n- [ ] Safe by default (disabled until explicitly enabled)","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-05T18:43:33.490673-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:43:33.490673-05:00","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-6nh.10","depends_on_id":"bobbin-6nh","type":"parent-child","created_at":"2026-01-05T18:43:33.492573-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6nh.10","depends_on_id":"bobbin-6nh.9","type":"blocks","created_at":"2026-01-05T18:43:38.849746-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6nh.2","title":"Add tool.* event types to tambour","description":"Extend tambour's event system with new event types for tool use tracking.\n\n## Purpose\nEnable the metrics system to receive tool use events from Claude Code sessions via tambour's existing event dispatcher.\n\n## New Event Types\n\n| Event | Trigger | Data Fields |\n|-------|---------|-------------|\n| `tool.used` | Any tool completes successfully | tool_name, tool_input, tool_response, session_id |\n| `tool.failed` | Tool returns error | Same as above + error details |\n| `session.started` | Claude session begins | session_id, issue_id, worktree |\n| `session.file_read` | Read tool completes | file_path, lines, success |\n| `session.file_written` | Write/Edit completes | file_path, success |\n\n## Implementation\n\n### Update events.py\n```python\n# tambour/src/tambour/events.py\n\n# Add to EventType enum or event registry\nTOOL_EVENTS = [\n    \"tool.used\",\n    \"tool.failed\",\n    \"session.started\",\n    \"session.file_read\",\n    \"session.file_written\",\n]\n```\n\n### Event Data Schema\n```python\n@dataclass\nclass ToolUsedEvent:\n    tool_name: str\n    tool_input: dict\n    tool_response: dict\n    session_id: str\n    timestamp: str\n    issue_id: Optional[str] = None\n    worktree: Optional[str] = None\n```\n\n### CLI Support\n```bash\n# Should work after implementation\npython -m tambour events emit tool.used --data '{\"tool_name\": \"Read\", ...}'\n```\n\n## Testing\n- Unit tests for new event types\n- Integration test: emit event, verify dispatcher routes to plugin\n- Test with malformed data (graceful error handling)\n\n## Acceptance Criteria\n- [ ] New event types registered in tambour\n- [ ] `tambour events emit tool.used` works from CLI\n- [ ] Event dispatcher routes tool.* events to subscribed plugins\n- [ ] Documentation updated","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-05T18:35:46.303658-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:35:46.303658-05:00","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-6nh.2","depends_on_id":"bobbin-6nh","type":"parent-child","created_at":"2026-01-05T18:35:46.305588-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6nh.3","title":"Create Claude Code hook bridge script","description":"Create a thin bridge that receives Claude Code PostToolUse hook events and emits tambour events.\n\n## Purpose\nClaude Code hooks provide tool use data via stdin JSON. This bridge parses that data and emits tambour events, connecting Claude Code's hook system to tambour's plugin infrastructure.\n\n## Architecture\n```\nClaude Code PostToolUse hook\n        ↓ JSON via stdin\nBridge script (this task)\n        ↓ \npython -m tambour events emit tool.used --data '...'\n        ↓\nTambour event dispatcher\n        ↓\nSubscribed plugins (metrics-collector, etc.)\n```\n\n## Implementation\n\n### Script Location\n`tambour/src/tambour/hooks/bridge.py`\n\n### Input (from Claude Code via stdin)\n```json\n{\n  \"session_id\": \"abc123\",\n  \"tool_name\": \"Read\",\n  \"tool_input\": {\"file_path\": \"/path/to/file.rs\"},\n  \"tool_response\": {\"success\": true, \"lines\": 150},\n  \"tool_use_id\": \"toolu_xxx\",\n  \"cwd\": \"/path/to/project\"\n}\n```\n\n### Processing\n1. Read JSON from stdin\n2. Extract tool_name, tool_input, tool_response\n3. Determine success/failure from tool_response\n4. Infer issue_id from cwd (if in worktree)\n5. Emit appropriate tambour event:\n   - `tool.used` for successful tool use\n   - `tool.failed` if error detected\n\n### CLI Entry Point\n```bash\n# Called by Claude Code hook\npython -m tambour.hooks.bridge\n```\n\n### Claude Code Hook Configuration\n```json\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"Read|Write|Edit|Glob|Grep|Bash\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"python -m tambour.hooks.bridge\",\n            \"timeout\": 5\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## Key Requirements\n1. Parse JSON from stdin reliably\n2. Handle malformed input gracefully (never crash the hook)\n3. Complete in \u003c 5ms to avoid slowing agent\n4. Infer context (issue_id, worktree) from environment/cwd\n5. Support all captured tool types\n\n## Testing\n- Unit tests for JSON parsing\n- Tests for each tool type\n- Error handling tests (malformed input, missing fields)\n- Performance tests (\u003c 5ms execution)\n\n## Acceptance Criteria\n- [ ] Bridge script reads stdin JSON correctly\n- [ ] Emits tool.used/tool.failed events via tambour CLI\n- [ ] Handles all captured tool types (Read, Write, Edit, Glob, Grep, Bash)\n- [ ] Graceful error handling (no crashes)\n- [ ] Performance within budget (\u003c 5ms)","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-05T18:37:51.10671-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:37:51.10671-05:00","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-6nh.3","depends_on_id":"bobbin-6nh","type":"parent-child","created_at":"2026-01-05T18:37:51.108371-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6nh.3","depends_on_id":"bobbin-6nh.2","type":"blocks","created_at":"2026-01-05T18:37:54.630157-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6nh.4","title":"Implement metrics-collector plugin","description":"Create the metrics collector plugin that subscribes to tool.* events and stores metrics.\n\n## Purpose\nThis is the core plugin that receives tool use events from tambour's event dispatcher and persists them to JSONL storage for later analysis.\n\n## Architecture\n```\nTambour Event Dispatcher\n        ↓ tool.used event\nmetrics-collector plugin (this task)\n        ↓ \n.tambour/metrics.jsonl\n```\n\n## Plugin Configuration\n```toml\n# .tambour/config.toml\n[plugins.metrics-collector]\non = [\"tool.used\", \"tool.failed\"]\nrun = \"python -m tambour.metrics collect\"\nblocking = false\ntimeout = 5\n```\n\n## Implementation\n\n### Module Location\n`tambour/src/tambour/metrics/collector.py`\n\n### Input (from event dispatcher)\nEvent data passed via environment or stdin:\n```json\n{\n  \"event_type\": \"tool.used\",\n  \"timestamp\": \"2026-01-05T10:30:00Z\",\n  \"data\": {\n    \"tool_name\": \"Read\",\n    \"tool_input\": {\"file_path\": \"/path/to/file.rs\"},\n    \"tool_response\": {\"success\": true, \"lines\": 150},\n    \"session_id\": \"abc123\",\n    \"issue_id\": \"bobbin-xyz\",\n    \"worktree\": \"/path/to/worktree\"\n  }\n}\n```\n\n### Output (append to JSONL)\n```json\n{\n  \"timestamp\": \"2026-01-05T10:30:00Z\",\n  \"session_id\": \"abc123\",\n  \"issue_id\": \"bobbin-xyz\",\n  \"worktree\": \"/path/to/worktree\",\n  \"tool\": \"Read\",\n  \"input\": {\"file_path\": \"/path/to/file.rs\"},\n  \"output\": {\"success\": true, \"lines\": 150},\n  \"error\": null\n}\n```\n\n### Tool-Specific Field Extraction\n| Tool | Fields to Extract |\n|------|-------------------|\n| Read | file_path, offset, limit |\n| Write | file_path, content_length (computed) |\n| Edit | file_path, old_string_len, new_string_len |\n| Glob | pattern, path |\n| Grep | pattern, path, output_mode |\n| Bash | command_prefix (first token), description |\n\n### Storage\n- Path: `.tambour/metrics.jsonl`\n- Format: Newline-delimited JSON (one event per line)\n- Append-only (no locking needed for single writer)\n- Create directory if not exists\n\n### Error Handling\n- Never fail the plugin (would block event dispatch)\n- Log errors to stderr\n- Skip malformed events\n\n## CLI Entry Point\n```bash\npython -m tambour.metrics collect\n```\n\n## Testing\n- Unit tests for field extraction per tool type\n- Integration test: emit event, verify JSONL written\n- Error handling tests (malformed events, missing fields)\n- File creation tests (directory doesn't exist)\n\n## Acceptance Criteria\n- [ ] Plugin receives tool.* events from dispatcher\n- [ ] Extracts relevant fields based on tool type\n- [ ] Appends to .tambour/metrics.jsonl correctly\n- [ ] Handles errors gracefully (logs, doesn't crash)\n- [ ] Works as tambour plugin configuration","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-05T18:38:10.1299-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:38:10.1299-05:00","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-6nh.4","depends_on_id":"bobbin-6nh","type":"parent-child","created_at":"2026-01-05T18:38:10.131864-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6nh.4","depends_on_id":"bobbin-6nh.2","type":"blocks","created_at":"2026-01-05T18:38:14.077498-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6nh.4","depends_on_id":"bobbin-6nh.3","type":"blocks","created_at":"2026-01-05T18:38:14.117204-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6nh.5","title":"Implement metrics aggregation pipeline","description":"Build the aggregation system that derives useful statistics from raw metric events.\n\n## Purpose\nRaw JSONL events are verbose and expensive to scan repeatedly. Aggregation provides precomputed statistics for hot file detection, complexity analysis, and reporting.\n\n## Aggregation Levels\n\n### Per-File Stats\n```json\n{\n  \"file_path\": \"/path/to/src/main.rs\",\n  \"stats\": {\n    \"total_reads\": 47,\n    \"unique_sessions\": 12,\n    \"avg_reads_per_session\": 3.9,\n    \"total_edits\": 8,\n    \"edit_success_rate\": 0.875,\n    \"last_accessed\": \"2026-01-05T10:30:00Z\",\n    \"first_accessed\": \"2026-01-01T08:00:00Z\"\n  }\n}\n```\n\n### Per-Session Stats\n```json\n{\n  \"session_id\": \"abc123\",\n  \"issue_id\": \"bobbin-xyz\",\n  \"stats\": {\n    \"total_tool_uses\": 145,\n    \"unique_files_accessed\": 23,\n    \"read_count\": 67,\n    \"edit_count\": 12,\n    \"edit_success_rate\": 0.917,\n    \"start_time\": \"2026-01-05T08:00:00Z\",\n    \"end_time\": \"2026-01-05T10:30:00Z\"\n  }\n}\n```\n\n### Per-Tool Stats\n```json\n{\n  \"tool\": \"Edit\",\n  \"stats\": {\n    \"total_uses\": 413,\n    \"success_count\": 389,\n    \"failure_count\": 24,\n    \"success_rate\": 0.942\n  }\n}\n```\n\n## Implementation\n\n### Module Location\n`tambour/src/tambour/metrics/aggregator.py`\n\n### Storage\n- Raw events: `.tambour/metrics.jsonl`\n- Aggregations: `.tambour/metrics-agg.json`\n- Aggregations are computed on-demand and cached\n\n### API\n```python\nfrom tambour.metrics import aggregator\n\n# Compute/refresh aggregations (reads metrics.jsonl)\nagg = aggregator.compute(window_days=7)\n\n# Query aggregations\nhot_files = agg.get_files_by_reads(min_reads=5)\ncomplex_files = agg.get_files_with_high_reread_rate(threshold=3.0)\ntool_stats = agg.get_tool_stats()\nsession_stats = agg.get_session_stats(session_id=\"abc123\")\n```\n\n### Caching Strategy\n1. Compute aggregations from metrics.jsonl\n2. Cache result to metrics-agg.json with timestamp\n3. On next query, check if metrics.jsonl has newer entries\n4. If stale, recompute; otherwise return cached\n5. Support force refresh via CLI flag\n\n### Time Windows\n- Default window: 7 days\n- Configurable via CLI and config.toml\n- Events outside window excluded from aggregations\n\n## Testing\n- Unit tests for each aggregation type\n- Tests for cache invalidation logic\n- Performance tests with large metrics files (10k+ events)\n- Edge cases: empty file, single event, all events same file\n\n## Acceptance Criteria\n- [ ] Per-file aggregations computed correctly\n- [ ] Per-session aggregations computed correctly\n- [ ] Per-tool aggregations computed correctly\n- [ ] Caching works (reuses cached data when valid)\n- [ ] Time window filtering works\n- [ ] Performance acceptable for large files","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-05T18:38:30.880623-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:38:30.880623-05:00","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-6nh.5","depends_on_id":"bobbin-6nh","type":"parent-child","created_at":"2026-01-05T18:38:30.882437-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6nh.5","depends_on_id":"bobbin-6nh.4","type":"blocks","created_at":"2026-01-05T18:38:35.348923-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6nh.6","title":"Add metrics CLI commands","description":"Implement CLI interface for querying and managing metrics.\n\n## Purpose\nProvide visibility into collected metrics for manual analysis and debugging.\n\n## Commands\n\n### Show Metrics Summary\n```bash\npython -m tambour metrics show [--window DAYS]\n```\nOutput:\n```\n=== Tambour Metrics Summary (Last 7 Days) ===\nEvents collected: 2,847\nUnique sessions: 23\nUnique files: 156\n\nTool Usage:\n  Read:  1,247 (98.5% success)\n  Write:   436 (99.1% success)\n  Edit:    413 (94.2% success)\n  Bash:    711 (87.3% success)\n  Grep:     40 (100% success)\n```\n\n### List Hot Files\n```bash\npython -m tambour metrics hot-files [--threshold N] [--window DAYS] [--limit N]\n```\nOutput:\n```\n=== Hot Files (≥5 reads in 7 days) ===\n  47 reads  CLAUDE.md\n  34 reads  src/main.rs\n  28 reads  Cargo.toml\n  22 reads  src/lib.rs\n  ...\n```\n\n### Show File Details\n```bash\npython -m tambour metrics file \u003cpath\u003e\n```\nOutput:\n```\n=== Metrics for src/parser.rs ===\nTotal reads: 34\nUnique sessions: 8\nAverage reads per session: 4.25  ← High re-read rate\nEdit success rate: 75%\nLast accessed: 2026-01-05 10:30\nFirst accessed: 2026-01-01 08:00\n```\n\n### Show Session Details\n```bash\npython -m tambour metrics session \u003csession-id\u003e\n```\nOutput:\n```\n=== Session abc123 (bobbin-xyz) ===\nDuration: 2h 30m\nTool uses: 145\nFiles accessed: 23\nRead operations: 67\nEdit operations: 12 (91.7% success)\n```\n\n### Show Complexity Warnings\n```bash\npython -m tambour metrics complexity [--threshold N]\n```\nOutput:\n```\n=== Files with Complexity Signals ===\nsrc/parser.rs\n  - High re-read rate: 4.25 per session (threshold: 3.0)\n  - Edit failure rate: 25%\n  - Recommendation: Add documentation\n\nsrc/ast.rs\n  - Very high re-read rate: 6.1 per session\n  - Recommendation: Consider refactoring or splitting\n```\n\n### Clear Old Metrics\n```bash\npython -m tambour metrics clear [--older-than DAYS] [--dry-run]\n```\n\n### Refresh Aggregations\n```bash\npython -m tambour metrics refresh [--force]\n```\n\n## Implementation\n\n### Module Location\n`tambour/src/tambour/metrics/cli.py`\n\n### Integration\n- Extend existing `tambour/__main__.py` with metrics subcommand\n- Use argparse for argument parsing\n- Table formatting for output (simple ASCII, no external deps)\n\n### Error Handling\n- Graceful handling of missing metrics.jsonl\n- Clear error messages for invalid arguments\n- Exit codes for scripting (0=success, 1=error)\n\n## Testing\n- Integration tests for each command\n- Test with empty metrics file\n- Test with large metrics file\n- Test argument parsing and validation\n\n## Acceptance Criteria\n- [ ] `tambour metrics show` displays summary\n- [ ] `tambour metrics hot-files` lists files by read count\n- [ ] `tambour metrics file \u003cpath\u003e` shows file details\n- [ ] `tambour metrics complexity` shows warning signals\n- [ ] `tambour metrics clear` removes old events\n- [ ] All commands handle edge cases gracefully","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-05T18:38:55.555969-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:38:55.555969-05:00","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-6nh.6","depends_on_id":"bobbin-6nh","type":"parent-child","created_at":"2026-01-05T18:38:55.557576-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6nh.6","depends_on_id":"bobbin-6nh.5","type":"blocks","created_at":"2026-01-05T18:38:58.864714-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6nh.7","title":"Implement hot file detection algorithm","description":"Create the algorithm that identifies frequently-accessed files for context injection.\n\n## Purpose\nFiles that are read repeatedly across sessions are strong candidates for automatic context injection. This task implements the detection logic.\n\n## Algorithm\n\n### Basic Hot File Detection\n```python\ndef get_hot_files(aggregations, config):\n    \"\"\"\n    Returns files that exceed the read threshold within the time window.\n    \n    Args:\n        aggregations: Precomputed file aggregations\n        config: MetricsConfig with thresholds\n    \n    Returns:\n        List of (file_path, read_count) sorted by read_count desc\n    \"\"\"\n    threshold = config.hot_files.threshold  # default: 5\n    window_days = config.hot_files.window_days  # default: 7\n    max_files = config.hot_files.max_inject  # default: 10\n    \n    hot = []\n    for file_path, stats in aggregations.files.items():\n        if stats.total_reads \u003e= threshold:\n            hot.append((file_path, stats.total_reads))\n    \n    hot.sort(key=lambda x: x[1], reverse=True)\n    return hot[:max_files]\n```\n\n### Advanced Signals (Future Enhancement)\nBeyond simple read counts, consider:\n- **Recency weighting** - Recent reads count more than old ones\n- **Session spread** - File read in many sessions vs few\n- **Read-to-edit ratio** - Files read but rarely edited may be references\n- **File type weighting** - Config files vs source code\n\n### Configuration\n```toml\n[metrics.hot_files]\nthreshold = 5          # Minimum reads to be considered hot\nwindow_days = 7        # Time window for analysis\nmax_inject = 10        # Maximum files to inject\nexclude_patterns = [   # Files to never consider hot\n    \"*.lock\",\n    \"node_modules/*\",\n    \".git/*\"\n]\n```\n\n## Implementation\n\n### Module Location\n`tambour/src/tambour/metrics/hot_files.py`\n\n### API\n```python\nfrom tambour.metrics.hot_files import HotFileDetector\n\ndetector = HotFileDetector(config)\nhot_files = detector.detect(aggregations)\n\n# Returns list of HotFile objects\nfor hf in hot_files:\n    print(f\"{hf.path}: {hf.read_count} reads, {hf.session_count} sessions\")\n```\n\n### Output Format\n```python\n@dataclass\nclass HotFile:\n    path: str\n    read_count: int\n    session_count: int\n    last_read: datetime\n    score: float  # Composite score for ranking\n```\n\n## Testing\n- Unit tests for threshold logic\n- Tests for exclude patterns\n- Tests for edge cases (tie-breaking, exactly at threshold)\n- Integration test with real aggregations\n\n## Acceptance Criteria\n- [ ] Detects files exceeding read threshold\n- [ ] Respects configuration (threshold, window, max)\n- [ ] Excludes files matching exclude patterns\n- [ ] Returns sorted by relevance\n- [ ] Works with aggregation pipeline output","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-05T18:39:29.197758-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:39:29.197758-05:00","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-6nh.7","depends_on_id":"bobbin-6nh","type":"parent-child","created_at":"2026-01-05T18:39:29.199407-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6nh.7","depends_on_id":"bobbin-6nh.5","type":"blocks","created_at":"2026-01-05T18:39:33.030104-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6nh.8","title":"Implement context-injector plugin","description":"Create the plugin that injects hot file context into new agent sessions.\n\n## Purpose\nWhen a new Claude session starts, automatically provide context about frequently-accessed files to reduce repetitive reads and improve agent efficiency.\n\n## Architecture\n```\nClaude Code SessionStart hook\n        ↓\npython -m tambour.hooks.bridge (emits session.started)\n        ↓\nTambour Event Dispatcher\n        ↓\ncontext-injector plugin (this task)\n        ↓\nReturns context to inject into session\n```\n\n## Plugin Configuration\n```toml\n[plugins.context-injector]\non = \"session.started\"\nrun = \"python -m tambour.metrics inject-context\"\nblocking = true  # Must complete before session continues\ntimeout = 10\n```\n\n## Implementation\n\n### Module Location\n`tambour/src/tambour/metrics/context_injector.py`\n\n### Session Context Injection\nClaude Code's SessionStart hook supports returning context via stdout:\n```json\n{\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"SessionStart\",\n    \"additionalContext\": \"Hot files from recent sessions:\\n- CLAUDE.md (47 reads)\\n- src/main.rs (34 reads)...\"\n  }\n}\n```\n\n### Context Format\n```\n=== Frequently Accessed Files ===\nBased on metrics from recent sessions, these files are commonly referenced:\n\n1. CLAUDE.md (47 reads across 12 sessions)\n   - Project instructions and guidelines\n\n2. src/main.rs (34 reads across 10 sessions)\n   - Main entry point\n\n3. Cargo.toml (28 reads across 11 sessions)\n   - Project configuration\n\nConsider reading these files if relevant to your task.\n```\n\n### Optional: Pre-read File Contents\nFor highest-value files, could include actual content:\n```\n=== Auto-loaded Context ===\n\n--- CLAUDE.md ---\n[file contents here]\n---\n```\n\nThis is configurable and opt-in due to context size concerns.\n\n### Configuration\n```toml\n[metrics.context_injection]\nenabled = true\nmax_files = 5\ninclude_contents = false  # If true, include file contents\nmax_content_lines = 100   # Limit per file if including contents\n```\n\n## Integration with Claude Code Hooks\n\n### Hook Configuration\n```json\n{\n  \"hooks\": {\n    \"SessionStart\": [\n      {\n        \"matcher\": \"\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"python -m tambour.metrics inject-context\",\n            \"timeout\": 10\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Output Format\nScript outputs JSON to stdout for Claude Code to process:\n```json\n{\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"SessionStart\",\n    \"additionalContext\": \"...\"\n  }\n}\n```\n\n## Testing\n- Unit tests for context formatting\n- Integration test: session start, verify context injected\n- Test with no hot files (graceful empty output)\n- Test with many hot files (respects max_files)\n- Test content inclusion (when enabled)\n\n## Acceptance Criteria\n- [ ] Plugin triggers on session.started event\n- [ ] Uses hot file detection to identify relevant files\n- [ ] Outputs properly formatted context for Claude Code\n- [ ] Respects configuration (enabled, max_files, etc.)\n- [ ] Handles edge cases (no metrics, no hot files)\n- [ ] Performance acceptable (\u003c 10s timeout)","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-05T18:42:12.348402-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:42:12.348402-05:00","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-6nh.8","depends_on_id":"bobbin-6nh","type":"parent-child","created_at":"2026-01-05T18:42:12.350317-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6nh.8","depends_on_id":"bobbin-6nh.7","type":"blocks","created_at":"2026-01-05T18:42:17.207205-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6nh.8","depends_on_id":"bobbin-6nh.3","type":"blocks","created_at":"2026-01-05T18:42:17.246587-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6nh.9","title":"Implement complexity detection heuristics","description":"Create the algorithm that identifies files showing signs of complexity or documentation needs.\n\n## Purpose\nSome files consistently cause problems for agents - multiple re-reads, failed edits, long exploration times. Detecting these patterns helps identify candidates for documentation improvements or refactoring.\n\n## Complexity Signals\n\n### 1. High Re-read Rate\nFiles read multiple times within a single session suggest the agent is struggling to understand or find information.\n\n```python\nsignal = {\n    \"type\": \"high_reread_rate\",\n    \"threshold\": 3.0,  # avg reads per session\n    \"value\": 4.25,\n    \"severity\": \"warning\"\n}\n```\n\n### 2. Edit Failure Rate\nFiles where edits frequently fail (old_string not found) suggest unclear or unexpected structure.\n\n```python\nsignal = {\n    \"type\": \"edit_failures\",\n    \"threshold\": 0.25,  # 25% failure rate\n    \"value\": 0.33,\n    \"severity\": \"warning\"\n}\n```\n\n### 3. High Churn\nFiles edited many times per session might indicate unclear requirements or complex logic.\n\n```python\nsignal = {\n    \"type\": \"high_churn\",\n    \"threshold\": 5,  # edits per session\n    \"value\": 7,\n    \"severity\": \"info\"\n}\n```\n\n### 4. Read-without-Edit Pattern\nFiles that are always read but never edited might need better documentation or could be candidates for pre-loading.\n\n```python\nsignal = {\n    \"type\": \"read_only\",\n    \"threshold\": 10,  # reads with 0 edits\n    \"value\": 15,\n    \"severity\": \"info\"\n}\n```\n\n## Implementation\n\n### Module Location\n`tambour/src/tambour/metrics/complexity.py`\n\n### API\n```python\nfrom tambour.metrics.complexity import ComplexityDetector\n\ndetector = ComplexityDetector(config)\nresults = detector.analyze(aggregations)\n\nfor file_result in results:\n    print(f\"{file_result.path}:\")\n    for signal in file_result.signals:\n        print(f\"  - {signal.type}: {signal.value} (threshold: {signal.threshold})\")\n    print(f\"  Recommendation: {file_result.recommendation}\")\n```\n\n### Output Format\n```python\n@dataclass\nclass ComplexitySignal:\n    type: str\n    threshold: float\n    value: float\n    severity: str  # \"info\", \"warning\", \"critical\"\n\n@dataclass\nclass FileComplexity:\n    path: str\n    signals: List[ComplexitySignal]\n    recommendation: str  # Human-readable suggestion\n    score: float  # Composite complexity score\n```\n\n### Recommendations Engine\nBased on detected signals, generate actionable recommendations:\n\n| Signals | Recommendation |\n|---------|---------------|\n| high_reread + edit_failures | \"Add inline documentation; structure may be unclear\" |\n| high_reread only | \"Consider adding a summary comment at top of file\" |\n| edit_failures only | \"Review code structure; edits are failing to match\" |\n| high_churn | \"Consider breaking into smaller modules\" |\n| read_only (high reads) | \"Good candidate for pre-loading as context\" |\n\n### Configuration\n```toml\n[metrics.complexity]\nenabled = true\nreread_threshold = 3.0\nedit_failure_threshold = 0.25\nchurn_threshold = 5\nmin_sessions = 3  # Require data from at least N sessions\n```\n\n## Testing\n- Unit tests for each signal type\n- Tests for recommendation generation\n- Tests for edge cases (single session, no edits, etc.)\n- Integration test with real aggregations\n\n## Acceptance Criteria\n- [ ] Detects high re-read rate files\n- [ ] Detects edit failure patterns\n- [ ] Detects high churn files\n- [ ] Generates actionable recommendations\n- [ ] Respects configuration thresholds\n- [ ] Works with CLI (tambour metrics complexity)","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-05T18:43:03.384378-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:43:03.384378-05:00","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-6nh.9","depends_on_id":"bobbin-6nh","type":"parent-child","created_at":"2026-01-05T18:43:03.386274-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6nh.9","depends_on_id":"bobbin-6nh.5","type":"blocks","created_at":"2026-01-05T18:43:07.253471-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6vq","title":"Bobbin Phase 2: Intelligence","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-02T23:39:07.634771-05:00","created_by":"stiwi","updated_at":"2026-01-02T23:39:07.634771-05:00"}
{"id":"bobbin-6vq.1","title":"Implement Git Log Parser \u0026 Coupling Analysis","description":"## Objective\nBuild a temporal coupling graph from git history to understand which files change together.\n\n## Requirements\n- **Git Extraction**: Use `git log --name-only` or `git2-rs` to walk commit history.\n- **Algorithm**:\n  - Iterate through the last N commits (config: `coupling_depth`, default 1000).\n  - For each commit, identify the set of modified files.\n  - For every pair of files in that set, increment their co-change count.\n  - Calculate a normalized score (0.0-1.0) based on frequency and recency.\n- **Storage**: Store the graph in SQLite.\n- **Performance**: This should be efficient enough to run incrementally.\n\n## Schema\n```sql\nCREATE TABLE coupling (\n    file_a_id INTEGER NOT NULL,\n    file_b_id INTEGER NOT NULL,\n    score REAL NOT NULL,          -- Normalized coupling strength\n    co_changes INTEGER NOT NULL,  -- Raw count of commits where both changed\n    last_co_change INTEGER,       -- Timestamp of last co-occurrence\n    PRIMARY KEY (file_a_id, file_b_id),\n    FOREIGN KEY(file_a_id) REFERENCES files(id),\n    FOREIGN KEY(file_b_id) REFERENCES files(id)\n);\n```\n\n## Configuration\n- `[git]` section in `config.toml`:\n  - `coupling_enabled` (bool)\n  - `coupling_depth` (int)\n  - `coupling_threshold` (int)","status":"closed","priority":2,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T23:40:08.062008-05:00","created_by":"stiwi","updated_at":"2026-01-03T00:28:11.128703-05:00","closed_at":"2026-01-03T00:28:11.128703-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-6vq.1","depends_on_id":"bobbin-6vq","type":"parent-child","created_at":"2026-01-02T23:40:08.065432-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6vq.2","title":"CLI: bobbin related","description":"## Objective\nSurface files related to a target file to help developers and agents understand context.\n\n## Requirements\n- **Command**: `bobbin related \u003cfile_path\u003e`\n- **Logic**:\n  1. **Temporal Coupling**: Query the SQLite `coupling` table for files with high co-change scores with the target.\n  2. **(Future) Semantic Similarity**: Find files with similar vector embeddings (if applicable at file level).\n- **Output**:\n  - List of related files sorted by relevance score.\n  - Explanation of *why* they are related (e.g., \"Co-changed 15 times\", \"Semantically similar\").\n- **Flags**:\n  - `--limit \u003cn\u003e`: Max results (default 10).\n  - `--threshold \u003cscore\u003e`: Min score to include.\n  - `--json` output support.\n\n## Example Output\n```text\nRelated to src/index/git.rs:\n1. src/cli/related.rs (score: 0.85) - Co-changed 12 times\n2. src/storage/sqlite.rs (score: 0.45) - Co-changed 5 times\n```","status":"closed","priority":2,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T23:40:37.031225-05:00","created_by":"stiwi","updated_at":"2026-01-05T19:28:51.623234-05:00","closed_at":"2026-01-05T19:28:51.623234-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-6vq.2","depends_on_id":"bobbin-6vq","type":"parent-child","created_at":"2026-01-02T23:40:37.03309-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6vq.2","depends_on_id":"bobbin-6vq.1","type":"blocks","created_at":"2026-01-02T23:49:02.740572-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6vq.3","title":"CLI: bobbin history","description":"## Objective\nShow how a file has evolved over time to provide historical context.\n\n## Requirements\n- **Command**: `bobbin history \u003cfile_path\u003e`\n- **Logic**:\n  - Retrieve commit history for the specific file.\n  - Summarize changes (not just a raw git log).\n- **Features**:\n  - Link to issue IDs (e.g., `bobbin-123`) found in commit messages.\n  - Show stats: frequent authors, churn rate.\n- **Output**:\n  - Chronological list of significant changes.\n  - `--limit` support.\n\n## Example Output\n```text\nHistory for src/main.rs:\n- 2024-01-02 (stiwi): Added CLI args parsing (bobbin-apx)\n- 2024-01-01 (stiwi): Initial commit\n```","status":"closed","priority":2,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T23:40:55.329767-05:00","created_by":"stiwi","updated_at":"2026-01-05T21:26:17.043043-05:00","closed_at":"2026-01-05T21:26:17.043043-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-6vq.3","depends_on_id":"bobbin-6vq","type":"parent-child","created_at":"2026-01-02T23:40:55.331652-05:00","created_by":"stiwi"},{"issue_id":"bobbin-6vq.3","depends_on_id":"bobbin-6vq.1","type":"blocks","created_at":"2026-01-02T23:49:07.814878-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6vq.4","title":"Markdown Documentation Indexing","description":"## Objective\nIndex markdown documentation files to enable RAG over docs, not just code.\n\n## Requirements\n- **Chunking Strategy**:\n  - Do NOT use code chunking (Tree-sitter for code).\n  - Use **Header-based Chunking**: Split content by markdown headers (`#`, `##`, `###`).\n  - Preserve hierarchy in metadata (e.g., \"Title \u003e Section \u003e Subsection\").\n- **Storage**:\n  - **Vectors**: Store embeddings in **LanceDB**.\n  - **Chunk Type**: Set `chunk_type = 'doc'` in the schema.\n  - **Metadata**: Store file path, title, and section in SQLite.\n- **Search Integration**:\n  - Ensure `bobbin search` queries include these chunks.\n  - Add optional flag `--type doc` or `--doc-only`.\n\n## Implementation Details\n- Add markdown parser to the indexer pipeline.\n- Ensure embeddings are generated using the same model as code.","status":"closed","priority":2,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T23:48:01.7165-05:00","created_by":"stiwi","updated_at":"2026-01-03T00:13:29.944935-05:00","closed_at":"2026-01-03T00:13:29.944935-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-6vq.4","depends_on_id":"bobbin-6vq","type":"parent-child","created_at":"2026-01-02T23:48:01.718323-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6vq.5","title":"Support Configurable Embedding Models","description":"## Objective\nAllow users to select different embedding models to balance performance vs. quality.\n\n## Requirements\n- **Configuration**:\n  - Update `config.toml` to support `[embedding] model = \"name\"`.\n- **Supported Models**:\n  - `all-MiniLM-L6-v2` (Default): Fast, small (384 dims).\n  - `bge-small-en-v1.5`: Better quality, same size.\n  - (Optional) `gte-small`.\n- **Implementation**:\n  - Use `ort` (ONNX Runtime) to load models dynamically.\n  - Automatically download models on first use if missing.\n  - **Caching**: Store downloaded ONNX files in `~/.cache/bobbin/models` (XDG compliant).\n- **Migration**:\n  - If model changes, trigger a full re-index (vectors are incompatible across models).","status":"closed","priority":2,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T23:48:26.503247-05:00","created_by":"stiwi","updated_at":"2026-01-03T00:14:15.246868-05:00","closed_at":"2026-01-03T00:14:15.246868-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-6vq.5","depends_on_id":"bobbin-6vq","type":"parent-child","created_at":"2026-01-02T23:48:26.505138-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6vq.6","title":"Implement 'bobbin related' CLI logic","description":"## Objective\nImplement the query and display logic for `bobbin related` to expose the temporal coupling graph stored in SQLite.\n\n## Requirements\n- **Database Layer**:\n  - Implement `MetadataStore::get_coupling(file_path: \u0026str, limit: usize)`.\n  - Execute SQL join:\n    ```sql\n    SELECT f2.path, c.score, c.co_changes \n    FROM coupling c \n    JOIN files f1 ON c.file_a = f1.id \n    JOIN files f2 ON c.file_b = f2.id \n    WHERE f1.path = ? \n    ORDER BY c.score DESC \n    LIMIT ?\n    ```\n- **CLI Layer**:\n  - Update `src/cli/related.rs`.\n  - Resolve input path to canonical path matching the index.\n  - Handle `--json` output format using the `RelatedOutput` struct.\n  - Format human-readable output with colors (Score: `0.85`, Co-changes: `12`).\n\n## Edge Cases\n- **File Not Found**: Return clear error if file isn't in the index.\n- **No Relations**: Handle files that exist but have no coupling data (e.g. new files).\n\n## Dependencies\n- `rusqlite` for query execution.\n- Existing `FileCoupling` struct in types.","status":"closed","priority":1,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-03T01:18:40.066988-05:00","created_by":"stiwi","updated_at":"2026-01-05T18:34:47.211922-05:00","closed_at":"2026-01-05T18:34:47.211922-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-6vq.6","depends_on_id":"bobbin-6vq","type":"parent-child","created_at":"2026-01-03T01:18:40.070208-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6vq.7","title":"Implement Hybrid Search (RRF)","description":"## Objective\nImprove search relevance by combining Semantic Search (LanceDB) and Keyword Search (SQLite FTS) results.\n\n## Requirements\n- **Algorithm**:\n  - Implement Reciprocal Rank Fusion (RRF).\n  - Formula: `score = 1.0 / (k + rank)` (typical k=60).\n  - Alternative: Weighted sum if scores are normalized `config.search.semantic_weight`.\n- **Integration**:\n  - Parallelize queries to LanceDB and SQLite.\n  - Combine results by file/chunk ID.\n  - Re-sort based on fused score.\n- **Configuration**:\n  - Respect `semantic_weight` in `config.toml`.\n\n## Implementation Details\n- Create `HybridSearch` struct in `src/search/hybrid.rs`.\n- Update `bobbin search` to use `HybridSearch` instead of raw semantic search.","status":"closed","priority":2,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-03T01:19:15.849677-05:00","created_by":"stiwi","updated_at":"2026-01-05T21:42:55.180642-05:00","closed_at":"2026-01-05T21:42:55.180642-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-6vq.7","depends_on_id":"bobbin-6vq","type":"parent-child","created_at":"2026-01-03T01:19:15.851622-05:00","created_by":"stiwi"}]}
{"id":"bobbin-6vq.8","title":"Add support for Go, Java, and C++","description":"## Objective\nExpand language support beyond Rust, Python, and TS by integrating additional Tree-sitter grammars.\n\n## Requirements\n- **Languages**:\n  - Go (`tree-sitter-go`)\n  - Java (`tree-sitter-java`)\n  - C++ (`tree-sitter-cpp`)\n- **Extraction Logic**:\n  - Update `src/index/parser.rs`.\n  - Define chunk extraction rules for each language (functions, classes, methods, structs).\n  - Map language-specific node types to `ChunkType`.\n\n## Implementation Details\n- Add dependencies to `Cargo.toml`.\n- Implement tests for each new language in `parser.rs`.","status":"closed","priority":2,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-03T01:19:40.181384-05:00","created_by":"stiwi","updated_at":"2026-01-05T22:00:13.967398-05:00","closed_at":"2026-01-05T22:00:13.967398-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-6vq.8","depends_on_id":"bobbin-6vq","type":"parent-child","created_at":"2026-01-03T01:19:40.183214-05:00","created_by":"stiwi"}]}
{"id":"bobbin-7nl","title":"Implement tambour daemon","description":"Background process for health monitoring and event dispatch.\n\n## Requirements\n- Daemonize with PID file (~/.tambour/daemon.pid or .tambour/daemon.pid)\n- Periodic health checks (configurable interval, default 60s)\n- Graceful shutdown on SIGTERM/SIGINT\n- Logging to file with rotation\n\n## CLI Commands\n```bash\ntambour daemon start    # Start daemon (or: python -m tambour.daemon start)\ntambour daemon stop     # Stop daemon\ntambour daemon status   # Show if running, PID, uptime\n```\n\n## Health Check Loop\n1. Find all in_progress issues (bd list --status in_progress --json)\n2. For each, check if worktree exists and agent process running\n3. If zombie detected, emit health.zombie event\n4. If auto_recover=true in config, unclaim automatically\n\n## Language\nPython (signal handling, subprocess, basic daemon pattern)","status":"closed","priority":3,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T18:35:18.283318-05:00","created_by":"stiwi","updated_at":"2026-01-03T00:10:34.27463-05:00","closed_at":"2026-01-03T00:10:34.27463-05:00","close_reason":"Closed","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-7nl","depends_on_id":"bobbin-sev","type":"blocks","created_at":"2026-01-02T18:36:00.8795-05:00","created_by":"stiwi"},{"issue_id":"bobbin-7nl","depends_on_id":"bobbin-iac","type":"parent-child","created_at":"2026-01-02T18:36:08.876409-05:00","created_by":"stiwi"}]}
{"id":"bobbin-7o5","title":"Tree-sitter code parsing integration","description":"Integrate Tree-sitter for structural code parsing. Support Rust, TypeScript, and Python initially. Extract semantic chunks: functions, classes, modules, interfaces. Gracefully handle parse errors.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T15:32:36.059928-05:00","created_by":"stiwi","updated_at":"2026-01-02T16:18:58.658045-05:00","closed_at":"2026-01-02T16:18:58.658045-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-7o5","depends_on_id":"bobbin-07d","type":"parent-child","created_at":"2026-01-02T15:33:05.829449-05:00","created_by":"stiwi"},{"issue_id":"bobbin-7o5","depends_on_id":"bobbin-lqq","type":"blocks","created_at":"2026-01-02T15:33:23.435145-05:00","created_by":"stiwi"}]}
{"id":"bobbin-8h0","title":"ONNX embedding generation with all-MiniLM-L6-v2","description":"Integrate ort (ONNX Runtime) for local embedding generation. Bundle or download all-MiniLM-L6-v2 model. Generate 384-dim embeddings for code chunks. Support batched inference for performance.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T15:32:36.22197-05:00","created_by":"stiwi","updated_at":"2026-01-02T16:12:59.913618-05:00","closed_at":"2026-01-02T16:12:59.913621-05:00","dependencies":[{"issue_id":"bobbin-8h0","depends_on_id":"bobbin-07d","type":"parent-child","created_at":"2026-01-02T15:33:05.867192-05:00","created_by":"stiwi"},{"issue_id":"bobbin-8h0","depends_on_id":"bobbin-lqq","type":"blocks","created_at":"2026-01-02T15:33:23.474597-05:00","created_by":"stiwi"}]}
{"id":"bobbin-8wk","title":"Fix finish-agent.sh to force-remove worktrees after successful merge","description":"The finish-agent.sh script fails completely when removing worktrees that have uncommitted changes or unpushed commits, even after a successful merge. Because of 'set -e', the script exits before closing the issue or cleaning up the branch.\n\nThe script should:\n1. Attempt worktree removal without --force\n2. If removal fails, warn the user but continue with remaining cleanup (branch deletion, issue closing)\n3. Print a clear message that the worktree needs manual investigation\n4. Optionally list what's left in the worktree (uncommitted files, unpushed commits)\n\nThis ensures the issue gets closed and branch gets cleaned up, while alerting the user to investigate the stale worktree.","status":"closed","priority":2,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T18:49:06.931598-05:00","created_by":"stiwi","updated_at":"2026-01-02T19:12:43.863723-05:00","closed_at":"2026-01-02T19:12:43.863723-05:00","close_reason":"Closed","labels":["tambour"]}
{"id":"bobbin-9k5","title":"JSON output format support","description":"Add --json flag to all commands. Output structured JSON for programmatic consumption by AI agents. Include all relevant metadata in JSON responses.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T15:32:37.557847-05:00","created_by":"stiwi","updated_at":"2026-01-02T21:59:19.003331-05:00","closed_at":"2026-01-02T21:59:19.003331-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-9k5","depends_on_id":"bobbin-07d","type":"parent-child","created_at":"2026-01-02T15:33:06.211044-05:00","created_by":"stiwi"},{"issue_id":"bobbin-9k5","depends_on_id":"bobbin-xhd","type":"blocks","created_at":"2026-01-02T15:33:28.66344-05:00","created_by":"stiwi"},{"issue_id":"bobbin-9k5","depends_on_id":"bobbin-x67","type":"blocks","created_at":"2026-01-02T15:33:28.703069-05:00","created_by":"stiwi"}]}
{"id":"bobbin-9po","title":"Allow configuring exclude patterns in tree context provider","description":"The tree context provider currently has hardcoded exclude patterns (.git, node_modules, target, etc.). Add configuration support to allow users to customize these patterns in .tambour/config.toml.\n\n**Current behavior:**\nExclusions are hardcoded in tambour/providers/tree.sh\n\n**Desired behavior:**\nAllow configuration like:\n```toml\n[context.providers.tree]\nrun = \"tambour/providers/tree.sh\"\nexclude = [\".git\", \"node_modules\", \"custom_dir\"]\n```\n\n**Implementation notes:**\n- Pass exclude patterns to provider via environment variable (TREE_EXCLUDE already supported)\n- Update ContextProviderConfig to support arbitrary config options\n- Update tree.sh to read from config-provided TREE_EXCLUDE","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-02T20:53:38.802964-05:00","created_by":"stiwi","updated_at":"2026-01-02T21:52:53.464523-05:00","closed_at":"2026-01-02T21:52:53.464523-05:00","close_reason":"Closed","labels":["tambour"]}
{"id":"bobbin-ac2","title":"Implement plugin configuration parser","description":"Parse .tambour/config.toml for plugin definitions.\n\n## Requirements\n- Parse [plugins.*] sections from config\n- Validate required fields: on, run\n- Handle optional fields: blocking (default false), timeout (default 30), enabled (default true)\n- Error on invalid event names\n- Return structured plugin definitions for event dispatcher\n\n## Config Schema\n```toml\n[plugins.example]\non = \"branch.merged\"\nrun = \"bobbin index\"\nblocking = false\ntimeout = 60\nenabled = true\n```\n\n## Language\nPython (tomllib for parsing)","status":"closed","priority":3,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T18:34:49.118677-05:00","created_by":"stiwi","updated_at":"2026-01-02T22:10:57.329457-05:00","closed_at":"2026-01-02T22:10:57.329457-05:00","close_reason":"Closed","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-ac2","depends_on_id":"bobbin-uzr","type":"blocks","created_at":"2026-01-02T18:36:00.748397-05:00","created_by":"stiwi"},{"issue_id":"bobbin-ac2","depends_on_id":"bobbin-iac","type":"parent-child","created_at":"2026-01-02T18:36:08.750542-05:00","created_by":"stiwi"}]}
{"id":"bobbin-apx","title":"CLI: bobbin init command","description":"Implement 'bobbin init' command. Create .bobbin/ directory structure. Generate default config.toml. Initialize empty SQLite database and LanceDB store. Detect and respect .gitignore.","status":"closed","priority":1,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T15:32:36.778304-05:00","created_by":"stiwi","updated_at":"2026-01-02T19:12:25.72252-05:00","closed_at":"2026-01-02T19:12:25.72252-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-apx","depends_on_id":"bobbin-07d","type":"parent-child","created_at":"2026-01-02T15:33:06.050365-05:00","created_by":"stiwi"},{"issue_id":"bobbin-apx","depends_on_id":"bobbin-j0x","type":"blocks","created_at":"2026-01-02T15:33:25.217588-05:00","created_by":"stiwi"},{"issue_id":"bobbin-apx","depends_on_id":"bobbin-cj1","type":"blocks","created_at":"2026-01-02T15:33:25.258362-05:00","created_by":"stiwi"}]}
{"id":"bobbin-cg3","title":"Add agent heartbeat mechanism","description":"Agents write periodic heartbeats for liveness detection.\n\n## Problem\nCurrent zombie detection only checks if a Claude process is running. This fails if:\n- Agent is stuck/hung but process exists\n- Process detection is unreliable (PID reuse, etc.)\n\n## Solution\nAgents write a heartbeat file that the daemon monitors.\n\n## Implementation\n1. On agent spawn, create: `\u003cworktree\u003e/.tambour/heartbeat`\n2. Agent (or wrapper) updates timestamp periodically (every 30s)\n3. Daemon checks heartbeat age vs zombie_threshold config\n4. Stale heartbeat = zombie, even if process exists\n\n## Heartbeat File Format\n```json\n{\"timestamp\": \"2024-01-15T10:30:00Z\", \"pid\": 12345}\n```\n\n## Configuration\n```toml\n[daemon]\nzombie_threshold = 300  # seconds without heartbeat = zombie\n```","status":"closed","priority":4,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T18:35:29.517648-05:00","created_by":"stiwi","updated_at":"2026-01-03T00:41:58.227057-05:00","closed_at":"2026-01-03T00:41:58.227057-05:00","close_reason":"Closed","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-cg3","depends_on_id":"bobbin-7nl","type":"blocks","created_at":"2026-01-02T18:36:00.964547-05:00","created_by":"stiwi"},{"issue_id":"bobbin-cg3","depends_on_id":"bobbin-iac","type":"parent-child","created_at":"2026-01-02T18:36:08.962823-05:00","created_by":"stiwi"}]}
{"id":"bobbin-cj1","title":"SQLite metadata and FTS storage","description":"Set up SQLite database for metadata. Create tables: files, chunks, chunks_fts. Implement full-text search using FTS5. Track file hashes and modification times for incremental updates.","status":"closed","priority":1,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T15:32:36.590518-05:00","created_by":"stiwi","updated_at":"2026-01-02T18:22:47.410737-05:00","closed_at":"2026-01-02T18:22:47.410737-05:00","close_reason":"Implemented SQLite metadata store with FTS5, incremental update tracking, batch operations, and comprehensive tests","dependencies":[{"issue_id":"bobbin-cj1","depends_on_id":"bobbin-07d","type":"parent-child","created_at":"2026-01-02T15:33:05.943015-05:00","created_by":"stiwi"},{"issue_id":"bobbin-cj1","depends_on_id":"bobbin-lqq","type":"blocks","created_at":"2026-01-02T15:33:23.552297-05:00","created_by":"stiwi"}]}
{"id":"bobbin-dve","title":"Tone down worktree warning and provide cleanup command","description":"The warning about existing worktrees after an agent session ends should be toned down. Additionally, it should provide a worktree cleanup command for cases where the bead task is already closed and merging fails. \\n\\nSymptoms:\\n- 'just tambour finish \u003cissue\u003e' fails with 'not something we can merge' if the task is already closed or branch is missing.\\n- Worktree remains at ../bobbin-worktrees/\u003cissue\u003e.\\n\\nProposed Fix:\\n- Update finish-agent.sh/tambour.just to handle already-merged/closed states more gracefully.\\n- Tweak the warning message to be less alarming.\\n- Provide a clear 'bd worktree remove' or 'just tambour abort' command for cleanup.","status":"closed","priority":3,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T22:18:00.253359-05:00","created_by":"stiwi","updated_at":"2026-01-03T00:27:10.033533-05:00","closed_at":"2026-01-03T00:27:10.033533-05:00","close_reason":"Closed","labels":["tambour"]}
{"id":"bobbin-ec0","title":"Add event emission points to shell scripts","description":"Integrate event emission into existing Phase 1 shell scripts.\n\n## Events to Emit\n| Script | Event | Trigger Point |\n|--------|-------|---------------|\n| start-agent.sh | agent.spawned | After worktree created, before Claude starts |\n| start-agent.sh | task.claimed | After bd update --claim succeeds |\n| finish-agent.sh | branch.merged | After successful git merge |\n| finish-agent.sh | task.completed | After bd close succeeds |\n| health-check.sh | health.zombie | When zombie detected |\n\n## Implementation\n- Call Python event dispatcher from shell scripts\n- Pass required payload data as arguments\n- For agent.finished: capture Claude exit code, emit after Claude exits\n\n## Approach\nMinimal shell wrapper that calls: `python -m tambour.events emit \u003cevent\u003e --issue \u003cid\u003e ...`","status":"closed","priority":3,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T18:35:08.356973-05:00","created_by":"stiwi","updated_at":"2026-01-03T00:10:19.921404-05:00","closed_at":"2026-01-03T00:10:19.921404-05:00","close_reason":"Closed","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-ec0","depends_on_id":"bobbin-sev","type":"blocks","created_at":"2026-01-02T18:36:00.836743-05:00","created_by":"stiwi"},{"issue_id":"bobbin-ec0","depends_on_id":"bobbin-iac","type":"parent-child","created_at":"2026-01-02T18:36:08.834144-05:00","created_by":"stiwi"}]}
{"id":"bobbin-goe","title":"CLI: bobbin index command","description":"Implement 'bobbin index' command. Walk repository files respecting ignores. Parse files with Tree-sitter. Generate embeddings. Store in LanceDB and SQLite. Show progress during indexing.","status":"closed","priority":1,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T15:32:36.971009-05:00","created_by":"stiwi","updated_at":"2026-01-02T19:44:08.939329-05:00","closed_at":"2026-01-02T19:44:08.939332-05:00","dependencies":[{"issue_id":"bobbin-goe","depends_on_id":"bobbin-07d","type":"parent-child","created_at":"2026-01-02T15:33:06.089719-05:00","created_by":"stiwi"},{"issue_id":"bobbin-goe","depends_on_id":"bobbin-7o5","type":"blocks","created_at":"2026-01-02T15:33:26.798448-05:00","created_by":"stiwi"},{"issue_id":"bobbin-goe","depends_on_id":"bobbin-8h0","type":"blocks","created_at":"2026-01-02T15:33:26.838815-05:00","created_by":"stiwi"},{"issue_id":"bobbin-goe","depends_on_id":"bobbin-j0x","type":"blocks","created_at":"2026-01-02T15:33:26.87838-05:00","created_by":"stiwi"},{"issue_id":"bobbin-goe","depends_on_id":"bobbin-cj1","type":"blocks","created_at":"2026-01-02T15:33:26.918483-05:00","created_by":"stiwi"},{"issue_id":"bobbin-goe","depends_on_id":"bobbin-apx","type":"blocks","created_at":"2026-01-02T15:33:26.957254-05:00","created_by":"stiwi"}]}
{"id":"bobbin-iac","title":"Phase 2: The Needle - Plugin System \u0026 Daemon","description":"Implement event-driven plugin system and daemon for continuous operation.\n\nSee tambour/vision.md and tambour/prd.md for full context.\n\n## Goals\n- Event-driven plugin system via .tambour/config.toml\n- Background daemon for health monitoring and event dispatch\n- Improved health monitoring with heartbeats and auto-recovery\n\n## Success Criteria\n- Plugins execute on all defined events\n- Blocking plugins can gate workflow progression\n- Daemon runs reliably in background\n- At least one real plugin (bobbin refresh) works end-to-end","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-02T18:34:40.046872-05:00","created_by":"stiwi","updated_at":"2026-01-02T18:36:14.82685-05:00","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-iac","depends_on_id":"bobbin-3lt","type":"blocks","created_at":"2026-01-02T19:07:03.706034-05:00","created_by":"stiwi"}]}
{"id":"bobbin-j0x","title":"LanceDB vector storage integration","description":"Integrate LanceDB as embedded vector store. Store embeddings with metadata (file path, chunk name, line numbers). Implement approximate nearest neighbor search. Store in .bobbin/ directory.","status":"closed","priority":1,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T15:32:36.402394-05:00","created_by":"stiwi","updated_at":"2026-01-02T18:47:47.273701-05:00","closed_at":"2026-01-02T18:47:47.273701-05:00","close_reason":"Implemented LanceDB vector storage with ANN search, metadata storage, and batch operations","dependencies":[{"issue_id":"bobbin-j0x","depends_on_id":"bobbin-07d","type":"parent-child","created_at":"2026-01-02T15:33:05.90367-05:00","created_by":"stiwi"},{"issue_id":"bobbin-j0x","depends_on_id":"bobbin-lqq","type":"blocks","created_at":"2026-01-02T15:33:23.513955-05:00","created_by":"stiwi"}]}
{"id":"bobbin-lqq","title":"Project scaffolding: Rust workspace and dependencies","description":"Set up Rust workspace with Cargo.toml, configure dependencies: tree-sitter, lancedb, rusqlite, ort (ONNX runtime), clap (CLI), serde. Create initial module structure.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T15:32:35.902466-05:00","created_by":"stiwi","updated_at":"2026-01-02T16:00:50.229618-05:00","closed_at":"2026-01-02T16:00:50.229618-05:00","close_reason":"Completed: Rust workspace with Cargo.toml, all dependencies configured, module structure created (cli/, index/, search/, storage/), project compiles successfully","dependencies":[{"issue_id":"bobbin-lqq","depends_on_id":"bobbin-07d","type":"parent-child","created_at":"2026-01-02T15:33:05.79028-05:00","created_by":"stiwi"}]}
{"id":"bobbin-qtm","title":"Auto-inject directory structure at agent session start","description":"When a new agent session starts in a worktree, automatically inject an ASCII representation of the current working directory's contents recursively.\n\n**Problem:**\nAgents typically start by exploring the project structure:\n```\n⏺ I'll start working on this task. Let me first understand the project structure...\n⏺ Explore(Explore tambour package structure)\n  ⎿  Waiting…\n```\n\nThis wastes time and context on every new session.\n\n**Solution:**\nInject the directory tree automatically at session start, after the task context is loaded. This gives the agent immediate visibility into the codebase structure without manual exploration.\n\n**Implementation ideas:**\n- Use `tree` command or similar to generate ASCII representation\n- Inject after task/issue context is established\n- Consider depth limits or exclusion patterns (.git, node_modules, target, etc.)\n- Could be a tambour plugin or hook that fires on session start","status":"closed","priority":4,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T19:47:29.708037-05:00","created_by":"stiwi","updated_at":"2026-01-02T21:03:47.781346-05:00","closed_at":"2026-01-02T21:03:47.781346-05:00","close_reason":"Closed","labels":["tambour"]}
{"id":"bobbin-sev","title":"Implement event dispatcher for plugins","description":"Execute plugins when lifecycle events are emitted.\n\n## Requirements\n- Accept event type and payload\n- Find all plugins registered for that event\n- Execute plugins with payload as environment variables\n- Handle blocking vs non-blocking:\n  - blocking=true: wait for completion, fail workflow if non-zero exit\n  - blocking=false: fire-and-forget (log result async)\n- Respect timeout configuration\n- Log all plugin executions and results\n\n## Environment Variables (payload)\n```bash\nTAMBOUR_EVENT=\"branch.merged\"\nTAMBOUR_TIMESTAMP=\"2024-01-15T10:30:00Z\"\nTAMBOUR_ISSUE_ID=\"proj-a1b\"\nTAMBOUR_ISSUE_TITLE=\"Add user authentication\"\nTAMBOUR_BRANCH=\"proj-a1b\"\nTAMBOUR_WORKTREE=\"/path/to/worktree\"\nTAMBOUR_MAIN_REPO=\"/path/to/main\"\n# Plus event-specific vars\n```\n\n## Language\nPython (subprocess for execution)","status":"closed","priority":3,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T18:34:58.730357-05:00","created_by":"stiwi","updated_at":"2026-01-02T23:32:36.660447-05:00","closed_at":"2026-01-02T23:32:36.660447-05:00","close_reason":"Closed","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-sev","depends_on_id":"bobbin-ac2","type":"blocks","created_at":"2026-01-02T18:36:00.793422-05:00","created_by":"stiwi"},{"issue_id":"bobbin-sev","depends_on_id":"bobbin-iac","type":"parent-child","created_at":"2026-01-02T18:36:08.792858-05:00","created_by":"stiwi"}]}
{"id":"bobbin-uzr","title":"Set up tambour Python package structure","description":"Create the Python package foundation for Phase 2.\n\n## Directory Structure\n```\ntambour/\n├── vision.md\n├── prd.md\n└── src/\n    └── tambour/\n        ├── __init__.py\n        ├── __main__.py      # CLI entry point\n        ├── config.py        # Config parsing\n        ├── events.py        # Event types and dispatcher\n        ├── daemon.py        # Daemon implementation\n        └── health.py        # Health check logic\n```\n\n## Requirements\n- Python 3.11+ (for tomllib)\n- No external dependencies initially (stdlib only)\n- CLI via argparse or click\n- Entry point: `python -m tambour \u003ccommand\u003e`\n\n## Commands (stubs)\n```bash\npython -m tambour events emit \u003cevent\u003e [--issue ID] [--worktree PATH]\npython -m tambour daemon start|stop|status\npython -m tambour config validate\n```","status":"closed","priority":3,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T18:35:48.561135-05:00","created_by":"stiwi","updated_at":"2026-01-02T19:17:20.645243-05:00","closed_at":"2026-01-02T19:17:20.645243-05:00","close_reason":"Closed","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-uzr","depends_on_id":"bobbin-iac","type":"parent-child","created_at":"2026-01-02T18:36:08.702709-05:00","created_by":"stiwi"}]}
{"id":"bobbin-x67","title":"CLI: bobbin grep command (keyword)","description":"Implement 'bobbin grep \u003cpattern\u003e' command. Search SQLite FTS for keyword matches. Support regex patterns. Return matching chunks with context. Support case-sensitive and insensitive modes.","status":"closed","priority":1,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T15:32:37.36164-05:00","created_by":"stiwi","updated_at":"2026-01-02T20:58:36.633486-05:00","closed_at":"2026-01-02T20:58:36.633486-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-x67","depends_on_id":"bobbin-07d","type":"parent-child","created_at":"2026-01-02T15:33:06.172343-05:00","created_by":"stiwi"},{"issue_id":"bobbin-x67","depends_on_id":"bobbin-goe","type":"blocks","created_at":"2026-01-02T15:33:28.623936-05:00","created_by":"stiwi"}]}
{"id":"bobbin-xhd","title":"CLI: bobbin search command (semantic)","description":"Implement 'bobbin search \u003cquery\u003e' command. Embed query text. Search LanceDB for similar vectors. Return top-k results with file path, chunk name, line numbers, similarity score. Support --limit and --type flags.","status":"closed","priority":1,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T15:32:37.166319-05:00","created_by":"stiwi","updated_at":"2026-01-02T19:57:57.915392-05:00","closed_at":"2026-01-02T19:57:57.915392-05:00","close_reason":"Closed","dependencies":[{"issue_id":"bobbin-xhd","depends_on_id":"bobbin-07d","type":"parent-child","created_at":"2026-01-02T15:33:06.132986-05:00","created_by":"stiwi"},{"issue_id":"bobbin-xhd","depends_on_id":"bobbin-goe","type":"blocks","created_at":"2026-01-02T15:33:28.58375-05:00","created_by":"stiwi"}]}
{"id":"bobbin-ysn","title":"Create bobbin index refresh plugin","description":"Reference implementation: refresh bobbin index after merges.\n\n## Purpose\nWhen agent work is merged to main, the bobbin index becomes stale. This plugin refreshes it automatically.\n\n## Configuration\n```toml\n[plugins.refresh-bobbin]\non = \"branch.merged\"\nrun = \"bobbin index --incremental\"\nblocking = false\ntimeout = 120\n```\n\n## Behavior\n- Triggered after finish-agent.sh merges branch to main\n- Runs bobbin index in the main repo (not worktree)\n- Non-blocking: merge completes immediately, index refreshes in background\n- Logs result but doesn't fail the workflow\n\n## Validates\n- Plugin system works end-to-end\n- Non-blocking execution works correctly\n- Environment variables provide correct paths","status":"closed","priority":3,"issue_type":"task","assignee":"stiwi","created_at":"2026-01-02T18:35:38.845751-05:00","created_by":"stiwi","updated_at":"2026-01-03T01:24:35.860338-05:00","closed_at":"2026-01-03T01:24:35.860338-05:00","close_reason":"Closed","labels":["tambour"],"dependencies":[{"issue_id":"bobbin-ysn","depends_on_id":"bobbin-ec0","type":"blocks","created_at":"2026-01-02T18:36:00.921625-05:00","created_by":"stiwi"},{"issue_id":"bobbin-ysn","depends_on_id":"bobbin-iac","type":"parent-child","created_at":"2026-01-02T18:36:08.918536-05:00","created_by":"stiwi"}]}
{"id":"bobbin-yxf","title":"Create Bobbin Project Vision and PRD","description":"Review 'Local RAG and Context Injection.md' and discuss what the primary features of bobbin will be. Create a vision/mission document and full PRD.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-02T14:58:32.026786-05:00","created_by":"stiwi","updated_at":"2026-01-02T15:31:37.629985-05:00","closed_at":"2026-01-02T15:31:37.629985-05:00","close_reason":"Created VISION.md and PRD.md with full project scope, architecture, and phased roadmap"}
